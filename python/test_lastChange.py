import json
import lastChange

# 创建测试数据
test_data = {
  "arg1": [
    {
      "taskId": "RT1447944453643845632",
      "erpDeptId": None
    },
    {
      "taskId": "RT1447907840742146048",
      "erpDeptId": None
    },
    {
      "taskId": "RT1441009119353143296",
      "erpDeptId": None
    },
    {
      "taskId": "RT1440331413486858240",
      "erpDeptId": None
    },
    {
      "taskId": "RT1438930818231394304",
      "erpDeptId": None
    },
    {
      "taskId": "RT1435647395342868480",
      "erpDeptId": None
    }
  ],
  "arg2": "bearer eyJ0eXAiOiJKc29uV2ViVG9rZW4iLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJpc3N1c2VyIiwiYXVkIjoiYXVkaWVuY2UiLCJ0ZW5hbnRfaWQiOiIxMDAwMDAxIiwiZGVwdF9jb2RlIjoiIiwidXNlcl9pZCI6IjkwNzkyNDQ5OTI0MTU4NjY4OCIsInJvbGVfaWQiOiJXZWJVc2VyUm9sZShpZD05MTI0Nzk1NTU0MTY3MDcwNzIsIHVzZXJJZD05MDc5MjQ0OTkyNDE1ODY2ODgsIGFjY291bnQ9LCBuYW1lPSwgc291cmNlPS0xLCBwYXNzd29yZD0sIHJvbGVOYW1lPSwgcm9sZVR5cGU9LTEsIGRhdGFTY29wZT0tMSwgcm9sZUlkPTg4NjQzNjU4NjA3Mzc5NjYwOCwgcm9sZUlkRXh0PS0xLCB1cGRhdGVUaW1lPW51bGwsIGNyZWF0ZVRpbWU9bnVsbCksV2ViVXNlclJvbGUoaWQ9OTI5NzY3NjM2NDUyODU5OTA0LCB1c2VySWQ9OTA3OTI0NDk5MjQxNTg2Njg4LCBhY2NvdW50PSwgbmFtZT0sIHNvdXJjZT0tMSwgcGFzc3dvcmQ9LCByb2xlTmFtZT0sIHJvbGVUeXBlPS0xLCBkYXRhU2NvcGU9LTEsIHJvbGVJZD05Mjk3NjczOTk2NzE4MTYxOTIsIHJvbGVJZEV4dD0tMSwgdXBkYXRlVGltZT1udWxsLCBjcmVhdGVUaW1lPW51bGwpLFdlYlVzZXJSb2xlKGlkPTkzNTg1NTg4MDU5MjUxNTA3MiwgdXNlcklkPTkwNzkyNDQ5OTI0MTU4NjY4OCwgYWNjb3VudD0sIG5hbWU9LCBzb3VyY2U9LTEsIHBhc3N3b3JkPSwgcm9sZU5hbWU9LCByb2xlVHlwZT0tMSwgZGF0YVNjb3BlPS0xLCByb2xlSWQ9MjMsIHJvbGVJZEV4dD0tMSwgdXBkYXRlVGltZT1udWxsLCBjcmVhdGVUaW1lPW51bGwpLFdlYlVzZXJSb2xlKGlkPTk1MzI3MzEyNjA1OTA3MzUzNiwgdXNlcklkPTkwNzkyNDQ5OTI0MTU4NjY4OCwgYWNjb3VudD0sIG5hbWU9LCBzb3VyY2U9LTEsIHBhc3N3b3JkPSwgcm9sZU5hbWU9LCByb2xlVHlwZT0tMSwgZGF0YVNjb3BlPS0xLCByb2xlSWQ9MjQsIHJvbGVJZEV4dD0tMSwgdXBkYXRlVGltZT1udWxsLCBjcmVhdGVUaW1lPW51bGwpLFdlYlVzZXJSb2xlKGlkPTk1NTU1NDM3NjY2OTAyODM1MiwgdXNlcklkPTkwNzkyNDQ5OTI0MTU4NjY4OCwgYWNjb3VudD0sIG5hbWU9LCBzb3VyY2U9LTEsIHBhc3N3b3JkPSwgcm9sZU5hbWU9LCByb2xlVHlwZT0tMSwgZGF0YVNjb3BlPS0xLCByb2xlSWQ9NzcwMzU4NjEyNjM4ODMwNTkyLCByb2xlSWRFeHQ9LTEsIHVwZGF0ZVRpbWU9bnVsbCwgY3JlYXRlVGltZT1udWxsKSxXZWJVc2VyUm9sZShpZD05NjEyOTQzNjU0MzY5MDc1MjAsIHVzZXJJZD05MDc5MjQ0OTkyNDE1ODY2ODgsIGFjY291bnQ9LCBuYW1lPSwgc291cmNlPS0xLCBwYXNzd29yZD0sIHJvbGVOYW1lPSwgcm9sZVR5cGU9LTEsIGRhdGFTY29wZT0tMSwgcm9sZUlkPTk2MTI5MTY2MjIyNDM1MTIzMiwgcm9sZUlkRXh0PS0xLCB1cGRhdGVUaW1lPW51bGwsIGNyZWF0ZVRpbWU9bnVsbCksV2ViVXNlclJvbGUoaWQ9MTAzMzczNzA3MzczODk2NDk5MiwgdXNlcklkPTkwNzkyNDQ5OTI0MTU4NjY4OCwgYWNjb3VudD0sIG5hbWU9LCBzb3VyY2U9LTEsIHBhc3N3b3JkPSwgcm9sZU5hbWU9LCByb2xlVHlwZT0tMSwgZGF0YVNjb3BlPS0xLCByb2xlSWQ9ODY5MDQzNDkyMzExNDQ1NTA0LCByb2xlSWRFeHQ9LTEsIHVwZGF0ZVRpbWU9bnVsbCwgY3JlYXRlVGltZT1udWxsKSIsInVzZXJfbmFtZSI6IuS9meexs-mmmSIsImVudiI6InByb2QiLCJkZXB0X2lkIjoiLTEiLCJhY2NvdW50IjoiMDAxMTMxNDAiLCJjbGllbnRfaWQiOiJzYWJlciIsImV4cCI6MTc2NTk5ODAwMCwibmJmIjoxNzY1OTQxNzE3fQ.jlwuWeRN8voPvZY3oEoFdTcWtbd7iYZE32j8oqpVX88"
}

test_token = "test_token"

# 调用main函数
result = lastChange.main(test_data, test_token)

# 打印结果
print("返回结果:")
print(json.dumps(result, ensure_ascii=False, indent=2))

# 验证是否包含category_count字段
if "category_count" in result:
    print("\n✅ 成功：返回结果包含category_count字段")
    print(f"调账原因分类种类总数: {result['category_count']}")
else:
    print("\n❌ 失败：返回结果不包含category_count字段")
